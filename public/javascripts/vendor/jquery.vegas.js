// ----------------------------------------------------------------------------
// Vegas - jQuery plugin 
// Add awesome fullscreen backgrounds to your webpages.
// v 1.3
// Dual licensed under the MIT and GPL licenses.
// http://vegas.jaysalvat.com/
// ----------------------------------------------------------------------------
// Copyright (C) 2011 Jay Salvat
// http://jaysalvat.com/
// ----------------------------------------------------------------------------
// Permission is hereby granted, free of charge, to any person obtaining a copy
// of this software and associated documentation files ( the "Software" ), to deal
// in the Software without restriction, including without limitation the rights
// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
// copies of the Software, and to permit persons to whom the Software is
// furnished to do so, subject to the following conditions:
// 
// The above copyright notice and this permission notice shall be included in
// all copies or substantial portions of the Software.
// 
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
// THE SOFTWARE.
// ----------------------------------------------------------------------------
(function(e){function h(t,n){var r={align:"center",valign:"center"};e.extend(r,n);var i=e(window).width(),s=e(window).height(),o=t.width(),u=t.height(),a=s/i,f=u/o,l,c,h,p,d;a>f?(l=s/f,c=s):(l=i,c=i*f),d={width:l+"px",height:c+"px",top:"auto",bottom:"auto",left:"auto",right:"auto"},isNaN(parseInt(r.valign))?r.valign=="top"?d.top=0:r.valign=="bottom"?d.bottom=0:d.top=(s-c)/2:d.top=0-(c-s)/100*parseInt(r.valign)+"px",isNaN(parseInt(r.align))?r.align=="left"?d.left=0:r.align=="right"?d.right=0:d.left=(i-l)/2:d.left=0-(l-i)/100*parseInt(r.align)+"px",t.css(d)}function p(){r.prependTo("body").fadeIn()}function d(){r.fadeOut("fast",function(){e(this).remove()})}function v(){if(e("body").css("backgroundImage"))return e("body").css("backgroundImage").replace(/url\("?(.*?)"?\)/i,"$1")}var t=e("<img />").addClass("vegas-background"),n=e("<div />").addClass("vegas-overlay"),r=e("<div />").addClass("vegas-loading"),i=e(),s=null,o=[],u=0,a=5e3,f=function(){},l,c={init:function(n){var r={src:v(),align:"center",valign:"center",fade:0,loading:!0,load:function(){},complete:function(){}};e.extend(r,e.vegas.defaults.background,n),r.loading&&p();var s=t.clone();return s.css({position:"fixed",left:"0px",top:"0px"}).imagesLoadedForVegas(function(){if(s==i)return;e(window).bind("load resize.vegas",function(e){h(s,r)}),i.is("img")?(i.stop(),s.hide().insertAfter(i).fadeIn(r.fade,function(){e(".vegas-background").not(this).remove(),e("body").trigger("vegascomplete",[this,u-1]),r.complete.apply(s,[u-1])})):s.hide().prependTo("body").fadeIn(r.fade,function(){e("body").trigger("vegascomplete",[this,u-1]),r.complete.apply(this,[u-1])}),i=s,h(i,r),r.loading&&d(),e("body").trigger("vegasload",[i.get(0),u-1]),r.load.apply(i.get(0),[u-1]),u&&(e("body").trigger("vegaswalk",[i.get(0),u-1]),r.walk.apply(i.get(0),[u-1]))}).attr("src",r.src),e.vegas},destroy:function(t){if(!t||t=="background")e(".vegas-background, .vegas-loading").remove(),e(window).unbind("resize.vegas"),i=e();return t=="overlay"&&e(".vegas-overlay").remove(),e.vegas},overlay:function(t){var r={src:null,opacity:null};return e.extend(r,e.vegas.defaults.overlay,t),n.remove(),n.css({margin:"0",padding:"0",position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),r.src&&n.css("backgroundImage","url("+r.src+")"),r.opacity&&n.css("opacity",r.opacity),n.prependTo("body"),e.vegas},slideshow:function(t,n){var r={step:u,delay:a,preload:!1,backgrounds:o,walk:f};e.extend(r,e.vegas.defaults.slideshow,t),r.backgrounds!=o&&(t.step||(r.step=0),t.walk||(r.walk=function(){}),r.preload&&e.vegas("preload",r.backgrounds)),o=r.backgrounds,a=r.delay,u=r.step,f=r.walk,clearInterval(l);if(!o.length)return e.vegas;var c=function(){u<0&&(u=o.length-1);if(u>=o.length||!o[u-1])u=0;var t=o[u++];t.walk=r.walk,typeof t.fade=="undefined"&&(t.fade=r.fade),t.fade>r.delay&&(t.fade=r.delay),e.vegas(t)};return c(),n||(s=!1,e("body").trigger("vegasstart",[i.get(0),u-1])),s||(l=setInterval(c,r.delay)),e.vegas},next:function(){var t=u;return u&&(e.vegas("slideshow",{step:u},!0),e("body").trigger("vegasnext",[i.get(0),u-1,t-1])),e.vegas},previous:function(){var t=u;return u&&(e.vegas("slideshow",{step:u-2},!0),e("body").trigger("vegasprevious",[i.get(0),u-1,t-1])),e.vegas},jump:function(t){var n=u;return u&&(e.vegas("slideshow",{step:t},!0),e("body").trigger("vegasjump",[i.get(0),u-1,n-1])),e.vegas},stop:function(){var t=u;return u=0,s=null,clearInterval(l),e("body").trigger("vegasstop",[i.get(0),t-1]),e.vegas},pause:function(){return s=!0,clearInterval(l),e("body").trigger("vegaspause",[i.get(0),u-1]),e.vegas},get:function(e){if(e==null||e=="background")return i.get(0);if(e=="overlay")return n.get(0);if(e=="step")return u-1;if(e=="paused")return s},preload:function(t){var n=[];for(var r in t)if(t[r].src){var i=document.createElement("img");i.src=t[r].src,n.push(i)}return e.vegas}};e.vegas=function(t){if(c[t])return c[t].apply(this,Array.prototype.slice.call(arguments,1));if(typeof t=="object"||!t)return c.init.apply(this,arguments);e.error("Method "+t+" does not exist")},e.vegas.defaults={background:{},slideshow:{},overlay:{}},e.fn.imagesLoadedForVegas=function(e){function s(){e.call(t,n)}function o(){--r<=0&&this.src!==i&&(setTimeout(s),n.unbind("load error",o))}var t=this,n=t.find("img").add(t.filter("img")),r=n.length,i="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";return r||setTimeout(s,200),n.bind("load error",o).each(function(){if(this.complete||this.complete===undefined){var e=this.src;this.src=i,this.src=e}}),t}})(jQuery);